!function(n){var a={};function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=180)}({0:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},1:function(e,t,n){"use strict";var a;a=n(3).extend({elements:null,getDefaultElements:function(){return{}},bindEvents:function(){},onInit:function(){this.initElements(),this.bindEvents()},initElements:function(){this.elements=this.getDefaultElements()}}),e.exports=a},180:function(e,t,n){"use strict";var s,a,o;s=jQuery,a=n(1),o=a.extend({modules:{Module:n(3)},maintenanceMode:null,config:QazanaAdminConfig,getDefaultElements:function(){var e={$window:s(window),$body:s("body"),$switchMode:s("#qazana-switch-mode"),$goToEditLink:s("#qazana-go-to-edit-page-link"),$switchModeInput:s("#qazana-switch-mode-input"),$switchModeButton:s("#qazana-switch-mode-button"),$qazanaLoader:s(".qazana-loader"),$builderEditor:s("#qazana-editor"),$importButton:s("#qazana-import-template-trigger"),$importArea:s("#qazana-import-template-area"),$settingsForm:s("#qazana-settings-form"),$settingsTabsWrapper:s("#qazana-settings-tabs-wrapper")};return e.$settingsFormPages=e.$settingsForm.find(".qazana-settings-form-page"),e.$activeSettingsPage=e.$settingsFormPages.filter(".qazana-active"),e.$settingsTabs=e.$settingsTabsWrapper.children(),e.$activeSettingsTab=e.$settingsTabs.filter(".nav-tab-active"),e},toggleStatus:function(){var e=this.isQazanaMode();this.elements.$body.toggleClass("qazana-editor-active",e).toggleClass("qazana-editor-inactive",!e)},bindEvents:function(){var i=this;i.elements.$switchModeButton.on("click",function(e){if(e.preventDefault(),i.isQazanaMode())i.elements.$switchModeInput.val("");else{i.elements.$switchModeInput.val(!0);var t=s("#title");t.val()||t.val("Qazana #"+s("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),i.animateLoader(),s(document).on("heartbeat-tick.autosave",function(){i.elements.$window.off("beforeunload.edit-post"),location.href=i.elements.$goToEditLink.attr("href")})}i.toggleStatus()}),i.elements.$goToEditLink.on("click",function(){i.animateLoader()}),s("div.notice.qazana-message-dismissed").on("click","button.notice-dismiss, .qazana-button-notice-dismiss",function(e){e.preventDefault(),s.post(ajaxurl,{action:"qazana_set_admin_notice_viewed",notice_id:s(this).closest(".qazana-message-dismissed").data("notice_id")});var t=s(this).closest(".qazana-message-dismissed");t.fadeTo(100,0,function(){t.slideUp(100,function(){t.remove()})})}),s("#qazana-clear-cache-button").on("click",function(e){e.preventDefault();var t=s(this);t.removeClass("success").addClass("loading"),s.post(ajaxurl,{action:"qazana_clear_cache",_nonce:t.data("nonce")}).done(function(){t.removeClass("loading").addClass("success")})}),s("#qazana-library-sync-button").on("click",function(e){e.preventDefault();var t=s(this);t.removeClass("success").addClass("loading"),s.post(ajaxurl,{action:"qazana_reset_library",_nonce:t.data("nonce")}).done(function(){t.removeClass("loading").addClass("success")})}),s("#qazana-replace-url-button").on("click",function(e){e.preventDefault();var t=s(this),n=t.parents("tr"),a=n.find('[name="from"]'),o=n.find('[name="to"]');t.removeClass("success").addClass("loading"),s.post(ajaxurl,{action:"qazana_replace_url",from:a.val(),to:o.val(),_nonce:t.data("nonce")}).done(function(e){t.removeClass("loading"),e.success&&t.addClass("success"),i.getDialogsManager().createWidget("alert",{message:e.data}).show()})}),i.elements.$settingsTabs.on({click:function(e){e.preventDefault(),e.currentTarget.focus()},focus:function(){var e=location.href.replace(/#.*/,"");history.pushState({},"",e+this.hash),i.goToSettingsTabFromHash()}}),s(".qazana-rollback-button").on("click",function(e){e.preventDefault();var t=s(this);i.getDialogsManager().createWidget("confirm",{headerMessage:i.config.i18n.rollback_to_previous_version,message:i.config.i18n.rollback_confirm,strings:{confirm:i.config.i18n.yes,cancel:i.config.i18n.cancel},onConfirm:function(){t.addClass("loading"),location.href=t.attr("href")}}).show()}),s(".qazana_css_print_method select").on("change",function(){var e=s(".qazana-css-print-method-description");e.hide(),e.filter('[data-value="'+s(this).val()+'"]').show()}).trigger("change")},setMarionetteTemplateCompiler:function(){"undefined"!=typeof Marionette&&(Marionette.TemplateCache.prototype.compileTemplate=function(e,t){return t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g},_.template(e,t)})},onInit:function(){a.prototype.onInit.apply(this,arguments),this.setMarionetteTemplateCompiler(),this.initDialogsManager(),this.initTemplatesImport(),this.initMaintenanceMode(),this.goToSettingsTabFromHash(),this.roleManager.init(),this.extensionManager.init()},initDialogsManager:function(){var e;this.getDialogsManager=function(){return e||(e=new DialogsManager.Instance),e}},initTemplatesImport:function(){if(this.elements.$body.hasClass("post-type-qazana_library")){var e=this.elements.$importButton,t=this.elements.$importArea;this.elements.$formAnchor=s("h1"),s("#wpbody-content").find(".page-title-action:last").after(e),this.elements.$formAnchor.after(t),e.on("click",function(){s("#qazana-import-template-area").toggle()})}},initMaintenanceMode:function(){var e=n(181);this.maintenanceMode=new e},isQazanaMode:function(){return!!this.elements.$switchModeInput.val()},animateLoader:function(){this.elements.$goToEditLink.addClass("qazana-animate")},goToSettingsTabFromHash:function(){var e=location.hash.slice(1);e&&this.goToSettingsTab(e)},goToSettingsTab:function(e){var t=this.elements.$settingsFormPages.filter("#"+e);if(t.length){this.elements.$activeSettingsPage.removeClass("qazana-active"),this.elements.$activeSettingsTab.removeClass("nav-tab-active");var n=this.elements.$settingsTabs.filter("#qazana-settings-"+e);t.addClass("qazana-active"),n.addClass("nav-tab-active"),this.elements.$settingsForm.attr("action","options.php#"+e),this.elements.$activeSettingsPage=t,this.elements.$activeSettingsTab=n}},roleManager:{selectors:{body:"qazana-role-manager",row:".qazana-role-row",label:".qazana-role-label",excludedIndicator:".qazana-role-excluded-indicator",excludedField:'input[name="qazana_exclude_user_roles[]"]',controlsContainer:".qazana-role-controls",toggleHandle:".qazana-role-toggle",arrowUp:"dashicons-arrow-up",arrowDown:"dashicons-arrow-down"},toggle:function(e){var t=this,n=e.closest(t.selectors.row),a=n.find(t.selectors.toggleHandle).find(".dashicons"),o=n.find(t.selectors.controlsContainer);o.toggleClass("hidden"),o.hasClass("hidden")?a.removeClass(t.selectors.arrowUp).addClass(t.selectors.arrowDown):a.removeClass(t.selectors.arrowDown).addClass(t.selectors.arrowUp),t.updateLabel(n)},updateLabel:function(e){var t=e.find(this.selectors.excludedIndicator),n=e.find(this.selectors.excludedField).is(":checked");n?t.html(t.data("excluded-label")):t.html(""),this.setAdvancedState(e,n)},setAdvancedState:function(e,n){e.find('input[type="checkbox"]').not(this.selectors.excludedField).each(function(e,t){s(t).prop("disabled",n)})},bind:function(){var t=this;s(document).on("click",t.selectors.label+","+t.selectors.toggleHandle,function(e){e.stopPropagation(),e.preventDefault(),t.toggle(s(this))}).on("change",t.selectors.excludedField,function(){t.updateLabel(s(this).closest(t.selectors.row))})},init:function(){var n=this;s('body[class*="'+n.selectors.body+'"]').length&&(n.bind(),s(n.selectors.row).each(function(e,t){n.updateLabel(s(t))}))}},extensionManager:{selectors:{body:"qazana-extensions-manager",row:".qazana-extension-row",label:".qazana-extension-indicator",activedIndicator:".qazana-extension-active-indicator",activeWidgets:'input[name="qazana_extension-manage-widgets[]"]',controlsContainer:".qazana-extension-controls",toggleHandle:".qazana-extension-toggle",arrowUp:"dashicons-arrow-up",arrowDown:"dashicons-arrow-down"},toggle:function(e){var t=this,n=e.closest(t.selectors.row),a=n.find(t.selectors.toggleHandle).find(".dashicons"),o=n.find(t.selectors.controlsContainer);o.toggleClass("hidden"),o.hasClass("hidden")?a.removeClass(t.selectors.arrowUp).addClass(t.selectors.arrowDown):a.removeClass(t.selectors.arrowDown).addClass(t.selectors.arrowUp),t.updateLabel(n)},updateLabel:function(e){var t=e.find(this.selectors.activedIndicator),n=e.find(this.selectors.activeWidgets).is(":checked");n?t.html(t.data("label")):t.html(""),this.setAdvancedState(e,n)},setAdvancedState:function(e,n){e.find('input[type="checkbox"]').not(this.selectors.activeWidgets).each(function(e,t){s(t).prop("disabled",n)})},bind:function(){var t=this;s(document).on("click",t.selectors.label+","+t.selectors.toggleHandle,function(e){e.stopPropagation(),e.preventDefault(),t.toggle(s(this))}).on("change",t.selectors.activeWidgets,function(){t.updateLabel(s(this).closest(t.selectors.row))})},init:function(){var n=this;s('body[class*="'+n.selectors.body+'"]').length&&(n.bind(),s(n.selectors.row).each(function(e,t){n.updateLabel(s(t))}))}}}),s(function(){window.qazanaAdmin=new o,qazanaAdmin.elements.$window.trigger("qazana/admin/init")})},181:function(e,t,n){"use strict";var a;a=n(1).extend({getDefaultSettings:function(){return{selectors:{modeSelect:".qazana_maintenance_mode_mode select",maintenanceModeTable:"#tab-maintenance_mode table",maintenanceModeDescriptions:".qazana-maintenance-mode-description",excludeModeSelect:".qazana_maintenance_mode_exclude_mode select",excludeRolesArea:".qazana_maintenance_mode_exclude_roles",templateSelect:".qazana_maintenance_mode_template_id select",editTemplateButton:".qazana-edit-template",maintenanceModeError:".qazana-maintenance-mode-error"},classes:{isEnabled:"qazana-maintenance-mode-is-enabled"}}},getDefaultElements:function(){var e={},t=this.getSettings("selectors");return e.$modeSelect=jQuery(t.modeSelect),e.$maintenanceModeTable=e.$modeSelect.parents(t.maintenanceModeTable),e.$excludeModeSelect=e.$maintenanceModeTable.find(t.excludeModeSelect),e.$excludeRolesArea=e.$maintenanceModeTable.find(t.excludeRolesArea),e.$templateSelect=e.$maintenanceModeTable.find(t.templateSelect),e.$editTemplateButton=e.$maintenanceModeTable.find(t.editTemplateButton),e.$maintenanceModeDescriptions=e.$maintenanceModeTable.find(t.maintenanceModeDescriptions),e.$maintenanceModeError=e.$maintenanceModeTable.find(t.maintenanceModeError),e},bindEvents:function(){var e=this.getSettings(),n=this.elements;n.$modeSelect.on("change",function(){n.$maintenanceModeTable.toggleClass(e.classes.isEnabled,!!n.$modeSelect.val()),n.$maintenanceModeDescriptions.hide(),n.$maintenanceModeDescriptions.filter('[data-value="'+n.$modeSelect.val()+'"]').show()}).trigger("change"),n.$excludeModeSelect.on("change",function(){n.$excludeRolesArea.toggle("custom"===n.$excludeModeSelect.val())}).trigger("change"),n.$templateSelect.on("change",function(){var e=n.$templateSelect.val();if(!e)return n.$editTemplateButton.hide(),void n.$maintenanceModeError.show();var t=qazanaAdmin.config.home_url+"?p="+e+"&qazana";n.$editTemplateButton.prop("href",t).show(),n.$maintenanceModeError.hide()}).trigger("change")}}),e.exports=a},3:function(e,t,n){"use strict";function i(){var i,s=jQuery,t=arguments,r=this,o={};this.getItems=function(e,t){if(t){var n=t.split("."),a=n.splice(0,1);if(!n.length)return e[a];if(!e[a])return;return this.getItems(e[a],n.join("."))}return e},this.getSettings=function(e){return this.getItems(i,e)},this.setSettings=function(e,t,n){if(n||(n=i),"object"===(0,c.default)(e))return s.extend(n,e),r;var a=e.split("."),o=a.splice(0,1);return a.length?(n[o]||(n[o]={}),r.setSettings(a.join("."),t,n[o])):(n[o]=t,r)},this.forceMethodImplementation=function(e){var t=e.callee.name;throw new ReferenceError("The method "+t+" must to be implemented in the inheritor child.")},this.on=function(e,t){return"object"===(0,c.default)(e)?s.each(e,function(e){r.on(e,this)}):e.split(" ").forEach(function(e){o[e]||(o[e]=[]),o[e].push(t)}),r},this.off=function(e,t){if(!o[e])return r;if(!t)return delete o[e],r;var n=o[e].indexOf(t);return-1!==n&&delete o[e][n],r},this.trigger=function(e){var t="on"+e[0].toUpperCase()+e.slice(1),n=Array.prototype.slice.call(arguments,1);r[t]&&r[t].apply(r,n);var a=o[e];return a&&s.each(a,function(e,t){t.apply(r,n)}),r},this.getDeviceName=function(){return jQuery("body").data("qazana-device-mode")},r.__construct.apply(r,t),s.each(r,function(e){var t=r[e];"function"==typeof t&&(r[e]=function(){return t.apply(r,arguments)})}),function(){i=r.getDefaultSettings();var e=t[0];e&&s.extend(i,e)}(),r.trigger("init")}var c=n(0)(n(4));i.prototype.__construct=function(){},i.prototype.getDefaultSettings=function(){return{}},i.extendsCount=0,i.extend=function(e){function t(){return a.apply(this,arguments)}var n=jQuery,a=this;n.extend(t,a),(t.prototype=Object.create(n.extend({},a.prototype,e))).constructor=t;var o=++i.extendsCount;return t.prototype.getConstructorID=function(){return o},t.__super__=a.prototype,t},e.exports=i},4:function(t,e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=a=function(e){return n(e)}:t.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(e)}t.exports=a}});