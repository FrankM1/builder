!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=169)}({0:function(e,t,n){"use strict";var a;a=n(2).extend({elements:null,getDefaultElements:function(){return{}},bindEvents:function(){},onInit:function(){this.initElements(),this.bindEvents()},initElements:function(){this.elements=this.getDefaultElements()}}),e.exports=a},169:function(e,t,n){"use strict";!function(e){var t=n(0),a=t.extend({modules:{Module:n(2)},maintenanceMode:null,config:QazanaAdminConfig,getDefaultElements:function(){var t={$window:e(window),$body:e("body"),$switchMode:e("#qazana-switch-mode"),$goToEditLink:e("#qazana-go-to-edit-page-link"),$switchModeInput:e("#qazana-switch-mode-input"),$switchModeButton:e("#qazana-switch-mode-button"),$qazanaLoader:e(".qazana-loader"),$builderEditor:e("#qazana-editor"),$importButton:e("#qazana-import-template-trigger"),$importArea:e("#qazana-import-template-area"),$settingsForm:e("#qazana-settings-form"),$settingsTabsWrapper:e("#qazana-settings-tabs-wrapper")};return t.$settingsFormPages=t.$settingsForm.find(".qazana-settings-form-page"),t.$activeSettingsPage=t.$settingsFormPages.filter(".qazana-active"),t.$settingsTabs=t.$settingsTabsWrapper.children(),t.$activeSettingsTab=t.$settingsTabs.filter(".nav-tab-active"),t},toggleStatus:function(){var e=this.isQazanaMode();this.elements.$body.toggleClass("qazana-editor-active",e).toggleClass("qazana-editor-inactive",!e)},bindEvents:function(){var t=this;t.elements.$switchModeButton.on("click",function(n){if(n.preventDefault(),t.isQazanaMode())t.elements.$switchModeInput.val("");else{t.elements.$switchModeInput.val(!0);var a=e("#title");a.val()||a.val("Qazana #"+e("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),t.animateLoader(),e(document).on("heartbeat-tick.autosave",function(){t.elements.$window.off("beforeunload.edit-post"),location.href=t.elements.$goToEditLink.attr("href")})}t.toggleStatus()}),t.elements.$goToEditLink.on("click",function(){t.animateLoader()}),e("div.notice.qazana-message-dismissed").on("click","button.notice-dismiss, .qazana-button-notice-dismiss",function(t){t.preventDefault(),e.post(ajaxurl,{action:"qazana_set_admin_notice_viewed",notice_id:e(this).closest(".qazana-message-dismissed").data("notice_id")});var n=e(this).closest(".qazana-message-dismissed");n.fadeTo(100,0,function(){n.slideUp(100,function(){n.remove()})})}),e("#qazana-clear-cache-button").on("click",function(t){t.preventDefault();var n=e(this);n.removeClass("success").addClass("loading"),e.post(ajaxurl,{action:"qazana_clear_cache",_nonce:n.data("nonce")}).done(function(){n.removeClass("loading").addClass("success")})}),e("#qazana-library-sync-button").on("click",function(t){t.preventDefault();var n=e(this);n.removeClass("success").addClass("loading"),e.post(ajaxurl,{action:"qazana_reset_library",_nonce:n.data("nonce")}).done(function(){n.removeClass("loading").addClass("success")})}),e("#qazana-replace-url-button").on("click",function(n){n.preventDefault();var a=e(this),o=a.parents("tr"),i=o.find('[name="from"]'),s=o.find('[name="to"]');a.removeClass("success").addClass("loading"),e.post(ajaxurl,{action:"qazana_replace_url",from:i.val(),to:s.val(),_nonce:a.data("nonce")}).done(function(e){a.removeClass("loading"),e.success&&a.addClass("success"),t.getDialogsManager().createWidget("alert",{message:e.data}).show()})}),t.elements.$settingsTabs.on({click:function(e){e.preventDefault(),e.currentTarget.focus()},focus:function(){var e=location.href.replace(/#.*/,"");history.pushState({},"",e+this.hash),t.goToSettingsTabFromHash()}}),e(".qazana-rollback-button").on("click",function(n){n.preventDefault();var a=e(this);t.getDialogsManager().createWidget("confirm",{headerMessage:t.config.i18n.rollback_to_previous_version,message:t.config.i18n.rollback_confirm,strings:{confirm:t.config.i18n.yes,cancel:t.config.i18n.cancel},onConfirm:function(){a.addClass("loading"),location.href=a.attr("href")}}).show()}),e(".qazana_css_print_method select").on("change",function(){var t=e(".qazana-css-print-method-description");t.hide(),t.filter('[data-value="'+e(this).val()+'"]').show()}).trigger("change")},setMarionetteTemplateCompiler:function(){"undefined"!=typeof Marionette&&(Marionette.TemplateCache.prototype.compileTemplate=function(e,t){return t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g},_.template(e,t)})},onInit:function(){t.prototype.onInit.apply(this,arguments),this.setMarionetteTemplateCompiler(),this.initDialogsManager(),this.initTemplatesImport(),this.initMaintenanceMode(),this.goToSettingsTabFromHash(),this.roleManager.init(),this.extensionManager.init()},initDialogsManager:function(){var e;this.getDialogsManager=function(){return e||(e=new DialogsManager.Instance),e}},initTemplatesImport:function(){if(this.elements.$body.hasClass("post-type-qazana_library")){var t=this.elements.$importButton,n=this.elements.$importArea;this.elements.$formAnchor=e("h1"),e("#wpbody-content").find(".page-title-action:last").after(t),this.elements.$formAnchor.after(n),t.on("click",function(){e("#qazana-import-template-area").toggle()})}},initMaintenanceMode:function(){var e=n(170);this.maintenanceMode=new e},isQazanaMode:function(){return!!this.elements.$switchModeInput.val()},animateLoader:function(){this.elements.$goToEditLink.addClass("qazana-animate")},goToSettingsTabFromHash:function(){var e=location.hash.slice(1);e&&this.goToSettingsTab(e)},goToSettingsTab:function(e){var t=this.elements.$settingsFormPages.filter("#"+e);if(t.length){this.elements.$activeSettingsPage.removeClass("qazana-active"),this.elements.$activeSettingsTab.removeClass("nav-tab-active");var n=this.elements.$settingsTabs.filter("#qazana-settings-"+e);t.addClass("qazana-active"),n.addClass("nav-tab-active"),this.elements.$settingsForm.attr("action","options.php#"+e),this.elements.$activeSettingsPage=t,this.elements.$activeSettingsTab=n}},roleManager:{selectors:{body:"qazana-role-manager",row:".qazana-role-row",label:".qazana-role-label",excludedIndicator:".qazana-role-excluded-indicator",excludedField:'input[name="qazana_exclude_user_roles[]"]',controlsContainer:".qazana-role-controls",toggleHandle:".qazana-role-toggle",arrowUp:"dashicons-arrow-up",arrowDown:"dashicons-arrow-down"},toggle:function(e){var t=e.closest(this.selectors.row),n=t.find(this.selectors.toggleHandle).find(".dashicons"),a=t.find(this.selectors.controlsContainer);a.toggleClass("hidden"),a.hasClass("hidden")?n.removeClass(this.selectors.arrowUp).addClass(this.selectors.arrowDown):n.removeClass(this.selectors.arrowDown).addClass(this.selectors.arrowUp),this.updateLabel(t)},updateLabel:function(e){var t=e.find(this.selectors.excludedIndicator),n=e.find(this.selectors.excludedField).is(":checked");n?t.html(t.data("excluded-label")):t.html(""),this.setAdvancedState(e,n)},setAdvancedState:function(t,n){t.find('input[type="checkbox"]').not(this.selectors.excludedField).each(function(t,a){e(a).prop("disabled",n)})},bind:function(){var t=this;e(document).on("click",t.selectors.label+","+t.selectors.toggleHandle,function(n){n.stopPropagation(),n.preventDefault(),t.toggle(e(this))}).on("change",t.selectors.excludedField,function(){t.updateLabel(e(this).closest(t.selectors.row))})},init:function(){var t=this;e('body[class*="'+t.selectors.body+'"]').length&&(t.bind(),e(t.selectors.row).each(function(n,a){t.updateLabel(e(a))}))}},extensionManager:{selectors:{body:"qazana-extensions-manager",row:".qazana-extension-row",label:".qazana-extension-indicator",activedIndicator:".qazana-extension-active-indicator",activeWidgets:'input[name="qazana_extension-manage-widgets[]"]',controlsContainer:".qazana-extension-controls",toggleHandle:".qazana-extension-toggle",arrowUp:"dashicons-arrow-up",arrowDown:"dashicons-arrow-down"},toggle:function(e){var t=e.closest(this.selectors.row),n=t.find(this.selectors.toggleHandle).find(".dashicons"),a=t.find(this.selectors.controlsContainer);a.toggleClass("hidden"),a.hasClass("hidden")?n.removeClass(this.selectors.arrowUp).addClass(this.selectors.arrowDown):n.removeClass(this.selectors.arrowDown).addClass(this.selectors.arrowUp),this.updateLabel(t)},updateLabel:function(e){var t=e.find(this.selectors.activedIndicator),n=e.find(this.selectors.activeWidgets).is(":checked");n?t.html(t.data("label")):t.html(""),this.setAdvancedState(e,n)},setAdvancedState:function(t,n){t.find('input[type="checkbox"]').not(this.selectors.activeWidgets).each(function(t,a){e(a).prop("disabled",n)})},bind:function(){var t=this;e(document).on("click",t.selectors.label+","+t.selectors.toggleHandle,function(n){n.stopPropagation(),n.preventDefault(),t.toggle(e(this))}).on("change",t.selectors.activeWidgets,function(){t.updateLabel(e(this).closest(t.selectors.row))})},init:function(){var t=this;e('body[class*="'+t.selectors.body+'"]').length&&(t.bind(),e(t.selectors.row).each(function(n,a){t.updateLabel(e(a))}))}}});e(function(){window.qazanaAdmin=new a,qazanaAdmin.elements.$window.trigger("qazana/admin/init")})}(jQuery)},170:function(e,t,n){"use strict";var a;a=n(0).extend({getDefaultSettings:function(){return{selectors:{modeSelect:".qazana_maintenance_mode_mode select",maintenanceModeTable:"#tab-maintenance_mode table",maintenanceModeDescriptions:".qazana-maintenance-mode-description",excludeModeSelect:".qazana_maintenance_mode_exclude_mode select",excludeRolesArea:".qazana_maintenance_mode_exclude_roles",templateSelect:".qazana_maintenance_mode_template_id select",editTemplateButton:".qazana-edit-template",maintenanceModeError:".qazana-maintenance-mode-error"},classes:{isEnabled:"qazana-maintenance-mode-is-enabled"}}},getDefaultElements:function(){var e={},t=this.getSettings("selectors");return e.$modeSelect=jQuery(t.modeSelect),e.$maintenanceModeTable=e.$modeSelect.parents(t.maintenanceModeTable),e.$excludeModeSelect=e.$maintenanceModeTable.find(t.excludeModeSelect),e.$excludeRolesArea=e.$maintenanceModeTable.find(t.excludeRolesArea),e.$templateSelect=e.$maintenanceModeTable.find(t.templateSelect),e.$editTemplateButton=e.$maintenanceModeTable.find(t.editTemplateButton),e.$maintenanceModeDescriptions=e.$maintenanceModeTable.find(t.maintenanceModeDescriptions),e.$maintenanceModeError=e.$maintenanceModeTable.find(t.maintenanceModeError),e},bindEvents:function(){var e=this.getSettings(),t=this.elements;t.$modeSelect.on("change",function(){t.$maintenanceModeTable.toggleClass(e.classes.isEnabled,!!t.$modeSelect.val()),t.$maintenanceModeDescriptions.hide(),t.$maintenanceModeDescriptions.filter('[data-value="'+t.$modeSelect.val()+'"]').show()}).trigger("change"),t.$excludeModeSelect.on("change",function(){t.$excludeRolesArea.toggle("custom"===t.$excludeModeSelect.val())}).trigger("change"),t.$templateSelect.on("change",function(){var e=t.$templateSelect.val();if(!e)return t.$editTemplateButton.hide(),void t.$maintenanceModeError.show();var n=qazanaAdmin.config.home_url+"?p="+e+"&qazana";t.$editTemplateButton.prop("href",n).show(),t.$maintenanceModeError.hide()}).trigger("change")}}),e.exports=a},2:function(e,t,n){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){var e,t=jQuery,n=arguments,o=this,i={};this.getItems=function(e,t){if(t){var n=t.split("."),a=n.splice(0,1);if(!n.length)return e[a];if(!e[a])return;return this.getItems(e[a],n.join("."))}return e},this.getSettings=function(t){return this.getItems(e,t)},this.setSettings=function(n,i,s){if(s||(s=e),"object"===(void 0===n?"undefined":a(n)))return t.extend(s,n),o;var r=n.split("."),c=r.splice(0,1);return r.length?(s[c]||(s[c]={}),o.setSettings(r.join("."),i,s[c])):(s[c]=i,o)},this.forceMethodImplementation=function(e){var t=e.callee.name;throw new ReferenceError("The method "+t+" must to be implemented in the inheritor child.")},this.on=function(e,n){return"object"===(void 0===e?"undefined":a(e))?(t.each(e,function(e){o.on(e,this)}),o):(e.split(" ").forEach(function(e){i[e]||(i[e]=[]),i[e].push(n)}),o)},this.off=function(e,t){if(!i[e])return o;if(!t)return delete i[e],o;var n=i[e].indexOf(t);return-1!==n&&delete i[e][n],o},this.trigger=function(e){var n="on"+e[0].toUpperCase()+e.slice(1),a=Array.prototype.slice.call(arguments,1);o[n]&&o[n].apply(o,a);var s=i[e];return s?(t.each(s,function(e,t){t.apply(o,a)}),o):o},this.getDeviceName=function(){return jQuery("body").data("qazana-device-mode")},o.__construct.apply(o,n),t.each(o,function(e){var t=o[e];"function"==typeof t&&(o[e]=function(){return t.apply(o,arguments)})}),function(){e=o.getDefaultSettings();var a=n[0];a&&t.extend(e,a)}(),o.trigger("init")};o.prototype.__construct=function(){},o.prototype.getDefaultSettings=function(){return{}},o.extendsCount=0,o.extend=function(e){var t=jQuery,n=this,a=function(){return n.apply(this,arguments)};t.extend(a,n),(a.prototype=Object.create(t.extend({},n.prototype,e))).constructor=a;var i=++o.extendsCount;return a.prototype.getConstructorID=function(){return i},a.__super__=n.prototype,a},e.exports=o}});